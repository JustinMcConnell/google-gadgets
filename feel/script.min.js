var feelings=[];var prefs=new _IG_Prefs();var current=0;var paused=false;var writing=false;var options={data:{display:"xml",returnfields:"feeling,sentence,posttime,postdate,posturl,gender,born,country,state,city,lat,lon,conditions",feeling:"",gender:-1,agerange:"",conditions:"",country:"",state:"California",city:"",postyear:"",postmonth:"",postdate:"",limit:200},getUrl:function(){var A="http://api.wefeelfine.org:8080/ShowFeelings?encode=1&"+(this.data.display?"&display="+this.data.display:"")+(this.data.returnfields?"&returnfields="+this.data.returnfields:"")+(this.data.feeling?"&feeling="+this.data.feeling:"")+(this.data.gender>=0?"&gender="+this.data.gender:"")+(this.data.agerange?"&agerange="+this.data.agerange:"")+(this.data.conditions?"&conditions="+this.data.conditions:"")+(this.data.country?"&country="+this.data.country:"")+(this.data.state?"&state="+this.data.state:"")+(this.data.city?"&city="+this.data.city:"")+(this.data.limit?"&limit="+this.data.limit:"");if(this.data.postdate){A+="&postdate="+this.data.postyear+"-"+datePad(this.data.postmonth+1)+"-"+datePad(this.data.postdate)}else{if(this.data.postyear){A+="&postyear="+this.data.postyear}if(this.data.postmonth||(typeof this.data.postmonth=="number"&&this.data.postmonth===0)){A+="&postmonth="+datePad(this.data.postmonth+1)}}return A},getDesc:function(){var A=arguments[0]||"";var B=arguments[1]||"";var C="";C+=A+" from ";if(this.data.gender>=0){C+=genders[this.data.gender].toLowerCase()+"s "}else{C+="people "}if(this.data.agerange){C+="aged "+this.data.agerange+" "}if(this.data.feeling){C+="who feel "+this.data.feeling+" "}if(this.data.postdate){C+="on "+monthNamesShort[this.data.postmonth]+" "+this.data.postdate+", "+this.data.postyear+" "}else{if((this.data.postmonth||(this.data.postmonth===0&&this.data.postmonth!==""))&&this.data.postyear){C+="in "+monthNamesShort[this.data.postmonth]+" "+this.data.postyear+" "}else{if(this.data.postyear){C+="in "+this.data.postyear+" "}}}if(this.data.conditions){C+="when its "+conditions[this.data.conditions].toLowerCase()+" "}if(this.data.city||this.data.state||this.data.country){C+="in "}if(this.data.city){C+=this.data.city+" "}if(this.data.state){C+=this.data.state+" "}if(this.data.country){C+=this.data.country+" "}C+=B;return C}};window.onload=function(){loadFeelings();_IG_Analytics("UA-51692-4","/wefeelfine")};function loadFeelings(){current=0;_gel("list").innerHTML="";setStatus("");_IG_FetchXmlContent(options.getUrl(),_IG_Callback(xmlToJson,function(){setTimeout(function(){playPause("play")},1000);nextFeeling()}))}function xmlToJson(D){feelings=[];var A=D;if(A===null||typeof (A)!="object"||A.firstChild===null){alert("No xml data");return }var F;var E;if(A.firstChild&&A.firstChild.nodeName=="feelings"){E=A.firstChild.childNodes}else{if(A.childNodes[2]&&A.childNodes[2].nodeName=="feelings"){E=A.childNodes[2].childNodes}else{if(A.childNodes[1]&&A.childNodes[1].nodeName=="feelings"){E=A.childNodes[1].childNodes}}}for(var C=0;C<E.length;C++){if(E[C].nodeType!=1){continue}F={};for(var B=0;B<E[C].attributes.length;B++){F[E[C].attributes[B].nodeName]=E[C].attributes[B].nodeValue}feelings.push(F)}if(feelings.length===0){setStatus("No feelings found")}if(arguments[1]&&typeof arguments[1]=="function"){arguments[1]()}}function playPause(){var B=arguments[0]&&arguments[0].toLowerCase()=="pause"?true:false;var G=arguments[0]&&arguments[0].toLowerCase()=="play"?true:false;var D=B||!paused;var C=G||paused;var F=function(){paused=false;var H=_gel("playpause");H.title="Pause";H.innerHTML='<img class="icon" src="http://www.talisweb.com/justin/gmodules/feel/pause.gif" alt="Pause" width="20" height="20">Pause';if(!writing){nextFeeling()}};var E=function(){paused=true;var H=_gel("playpause");H.title="Play";H.innerHTML='<img class="icon" src="http://www.talisweb.com/justin/gmodules/feel/play.gif" alt="Play" width="20" height="20">Play'};var A;if(B&&paused){A=function(){}}else{if(B&&!paused){A=E}else{if(G&&paused){A=F}else{if(G&&!paused){A=function(){}}else{if(paused){A=F}else{if(!paused){A=E}}}}}}A()}function setStatus(B){var A=_gel("status");if(B){A.innerHTML=options.getDesc(B);A.style.display="block"}else{A.innerHTML="";A.style.display="none"}}function getBlog(A){if(/livejournal\.com/.test(A)){return"LiveJournal"}else{if(/blogspot\.com/.test(A)){return"Blogger"}}return"some random blog"}function nextFeeling(){if(current+1<=feelings.length){addFeeling(current);current++;return true}setStatus("No more feelings");return false}function drawCircle(C,D,B){if(C.getContext){var A=C.getContext("2d");A.clearRect(0,0,8,8);A.beginPath();A.arc(4,4,D,0,Math.PI*2,false);A.fillStyle=B;A.fill()}}function addFeeling(M){var D=feelings[M];var B=D.sentence;var E="#FFFFFF";if(D.feeling&&typeof cyc!=="undefined"&&cyc[D.feeling]){E="#"+cyc[D.feeling].c}if(D.feeling){var K=new RegExp("("+D.feeling+")","gi");var A="border-bottom-color:"+E;if(typeof cyc==="undefined"||!cyc[D.feeling]){A+=" font-weight:bold; font-style:italic;"}B=B.replace(K,"<span class='highlightedFeeling' style='"+A+"'>$1</span>")}var F=_gel("list");var J=document.createElement("li");J.id="item"+M;J.className="item";var H=document.createElement("a");H.target="_blank";H.href=D.posturl;H.id="text"+M;H.className="text";H.title="Read entire feeling on "+getBlog(D.posturl);H.innerHTML="&nbsp;";H.onmouseover=function(){this.style.color="#CE2457"};H.onmouseout=function(){this.style.color=""};var I=document.createElement("div");I.id="meta"+M;I.className="meta";I.innerHTML="&nbsp;";var G=document.createElement("div");G.className="feeling";G.id="feeling"+M;G.appendChild(H);G.appendChild(I);var C=document.createElement("canvas");C.id="canvas"+M;C.height=8;C.width=8;var L=document.createElement("div");L.id="canvasDiv"+M;L.className="dot";L.appendChild(C);J.appendChild(L);if(typeof G_vmlCanvasManager!="undefined"){G_vmlCanvasManager.initElement(C);C=J.getElementsByTagName("canvas")[0]}J.onmouseover=function(){drawCircle(C,3,E)};J.onmouseout=function(){drawCircle(C,2,E)};drawCircle(C,2,E);J.appendChild(G);F.appendChild(J);F.insertBefore(J,F.firstChild);writing=true;writeText(H,B,0,function(){I.innerHTML=getMetaInfo(M);setOpacity(I,0);I.style.visibility="visible";fadeIn(I,function(){writing=false;if(!paused){nextFeeling()}})})}function setOpacity(A,B){if(!A||B<0||B>1){return }if(typeof A.style.filter!=="undefined"){A.style.filter="alpha(opacity="+Math.round(B*100)+")"}else{A.style.opacity=B}}function fadeIn(A,D){var C=0;function B(){setOpacity(A,C);C+=0.1;if(C<1){setTimeout(B,40)}else{if(typeof D==="function"){D()}}}B()}function writeText(E,F,B,C){if(B<=F.length){var A=B;var H=B;var G=F.substring(A,H+1).indexOf("<");if(G!=-1){H=B+F.substring(A).indexOf(">")+2}E.innerHTML=F.substring(0,H);var D=function(){writeText(E,F,H+1,C)};setTimeout(D,15)}else{if(B>F.length){if(C){setTimeout(function(){C()},50)}}}}function getMetaInfo(A){var E="";var C=feelings[A];var B=new Date();var D=new Date(C.posttime*1000);E+=formatTime(B-D);E+=" / from ";E+=C.born?"a "+(B.getFullYear()-C.born)+" year old ":"someone ";E+=C.gender?genders[C.gender].toLowerCase()+" ":"";E+=C.city||C.state||C.country?"in ":"";E+=C.city?C.city+" ":"";E+=C.state?C.state+" ":"";E+=C.country?C.country+" ":"";E+=C.conditions?"when it was "+conditions[C.conditions].toLowerCase():"";return E}function formatTime(A){A=A/1000;if(A<60){return"<1 min ago"}else{if(A<60*2){return Math.floor(A/60)+" min ago"}else{if(A<60*60){return Math.floor(A/60)+" mins ago"}else{if(A<60*60*2){return Math.floor(A/60/60)+" hours ago"}else{if(A<60*60*24){return Math.floor(A/60/60)+" hours ago"}else{if(A<60*60*24*2){return Math.floor(A/60/60/24)+" day ago"}else{if(A>=60*60*24*2){return Math.floor(A/60/60/24)+" days ago"}else{return Math.floor(A)+" seconds ago"}}}}}}}}function datePad(A){if(A>0&&A<10){return"0"+A}return A}